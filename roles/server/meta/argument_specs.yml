---
argument_specs:
  main:
    short_description: Zabbix Server
    description:
      - This role installs and configures the Zabbix server on a Linux system.
    author:
      - Jim Tarpley (@trippsc2)
    options:
      vault_url:
        type: str
        required: false
        description:
          - The URL for accessing HashiCorp Vault.
          - Alternatively, this can be configured through ansible.cfg or environment variables.
      vault_token:
        type: str
        required: false
        description:
          - The token for accessing HashiCorp Vault.
          - Alternatively, this (or any other authentication method) can be configured through ansible.cfg or environment variables.
      zabbix_host:
        type: str
        required: true
        description:
          - The hostname or IP address of the Zabbix server for API requests.
      zabbix_port:
        type: int
        required: true
        description:
          - The port on which to connect to Zabbix server for API requests.
      zabbix_ssl:
        type: bool
        required: false
        default: false
        description:
          - Whether to use SSL for API requests.
      zabbix_validate_certs:
        type: bool
        required: false
        description:
          - Whether to validate SSL certificates for API requests.
          - If not specified, the default behavior is to validate certificates.
      zabbix_url_path:
        type: str
        required: false
        default: ''
        description:
          - The URL path for the Zabbix API.
          - If using Apache for web frontend, this should be set to `zabbix` unless configured otherwise.
          - If using NGINX for web frontend, this should be set to an empty string unless configured otherwise.
      zabbix_username:
        type: str
        required: true
        description:
          - The username to use for API requests.
      zabbix_password:
        type: str
        required: true
        no_log: true
        description:
          - The password to use for API requests.
      zbxserver_major_version:
        type: str
        required: true
        choices:
          - '7.2'
          - '7.0'
        description:
          - The major version of Zabbix to install.
          - This defaults to the latest supported version for the OS.
      zbxserver_configure_selinux:
        type: bool
        required: false
        description:
          - Whether to manage SELinux settings for the Zabbix server.
          - For EL systems, this defaults to true.
          - For other systems, this defaults to false.
      zbxserver_configure_firewall:
        type: bool
        required: false
        default: true
        description:
          - Whether to manage the host firewall for use with Zabbix server.
      zbxserver_configure_logrotate:
        type: bool
        required: false
        default: true
        description:
          - Whether to manage logrotate settings for the Zabbix server.
      zbxserver_configure_vault:
        type: bool
        required: false
        default: true
        description:
          - Whether to configure the Zabbix server to use HashiCorp Vault for database credentials and storing user credentials.
      zbxserver_user:
        type: str
        required: false
        default: zabbix
        description:
          - The Linux user as which the Zabbix server will run.
          - If *zbxserver_configure_vault* is set to false, this user will be used to connect to a PostgreSQL database.
          - This user will be created, if it does not already exist.
      zbxserver_group:
        type: str
        required: false
        default: zabbix
        description:
          - The primary Linux group of the *zbxserver_user* user.
          - This group will be created, if it does not already exist.
      zbxserver_additional_groups:
        type: list
        required: false
        elements: str
        description:
          - A list of additional Linux groups to which the *zbxserver_user* user will belong.
          - On Debian-based systems, this defaults to `ssl-cert`.
          - On EL systems, this will not be defined.
      zbxserver_firewall_type:
        type: str
        required: false
        choices:
          - firewalld
          - ufw
        description:
          - The type of host firewall to configure for use with Zabbix server.
          - For Debian and EL systems, this defaults to `firewalld`.
          - For Ubuntu systems, this defaults to `ufw`.
      zbxserver_database_type:
        type: str
        required: false
        default: postgresql
        choices:
          - postgresql
          - mysql
        description:
          - The database type of the Zabbix server.
      zbxserver_database_name:
        type: str
        required: false
        default: zabbix-server
        description:
          - The name of the database of the Zabbix server.
      zbxserver_allow_root:
        type: bool
        required: false
        default: false
        description:
          - Whether the Zabbix server daemon should run as the root user.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#allowroot'
      zbxserver_allow_software_update_check:
        type: bool
        required: false
        default: true
        description:
          - Whether the Zabbix server should check for software updates.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#allowsoftwareupdatecheck'
      zbxserver_enable_global_scripts:
        type: bool
        required: false
        default: true
        description:
          - Whether to enable global scripts for the Zabbix server.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#enableglobalscripts'
      zbxserver_listen_port:
        type: int
        required: false
        default: 10051
        description:
          - The port on which the Zabbix server will listen for agent connections.
          - Valid values are between 1024 and 32767.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#listenport'
      zbxserver_listen_ip:
        type: list
        required: false
        elements: str
        description:
          - The IP addresses on which the Zabbix server will listen for incoming connections.
          - If not specified, the server will listen on all available IP addresses.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#listenip'
      zbxserver_source_ip:
        type: list
        required: false
        elements: str
        description:
          - The IP address to use as the source address for outgoing connections.
          - If not specified, the OS TCP/IP stack will decide which address to use.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#sourceip'
      zbxserver_stats_allowed_ip:
        type: list
        elements: str
        required: false
        default:
          - '127.0.0.1'
        description:
          - The IP addresses from which Zabbix server statistics can be retrieved.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#statsallowedip'
      zbxserver_listen_backlog:
        type: int
        required: false
        description:
          - The maximum length of the queue of pending connections.
          - If not specified, the OS default will be used.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#listenbacklog'
      zbxserver_service_manager_sync_frequency:
        type: int
        required: false
        default: 30
        description:
          - The frequency at which the Zabbix server will synchronize with the service manager.
          - Valid values are between 1 and 3600.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#servicemanagersyncfrequency'
      zbxserver_web_service_url:
        type: str
        required: false
        description:
          - The URL of the Zabbix web service.
          - If not specified, the server will not use the web service.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#webservicesurl'
      zbxserver_web_driver_url:
        type: str
        required: false
        description:
          - The URL of the Zabbix web driver.
          - If not specified, the server will not use the web driver.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#webdriverurl'
      zbxserver_tls_ca_file:
        type: path
        required: false
        description:
          - The path to the CA certificate file used for validating the server certificate and any client certificate authentication attempts.
          - If not specified, certificates will not be validated.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#tlscacertfile'
      zbxserver_tls_crl_file:
        type: path
        required: false
        description:
          - The path to the certificate revocation list file.
          - If not specified, certificate revocation lists will not be checked.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#tlscrlfile'
      zbxserver_tls_cert_file:
        type: path
        required: false
        description:
          - The path to the server certificate file.
          - If not specified, the server will not use TLS encryption.
          - If specified, the *zbxserver_tls_key_file* option must also be specified.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#tlscertfile'
      zbxserver_tls_key_file:
        type: path
        required: false
        description:
          - The path to the server private key file.
          - If not specified, the server will not use TLS encryption.
          - If specified, the *zbxserver_tls_cert_file* option must also be specified.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#tlskeyfile'
      zbxserver_tls_cipher_cert_13:
        type: str
        required: false
        description:
          - The list of ciphers in OpenSSL format that the server will accept for TLS 1.3 connections with a certificate.
          - If not specified, the server will use the system-wide default ciphers.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#tlsciphercert13'
      zbxserver_tls_cipher_cert:
        type: str
        required: false
        description:
          - The list of ciphers in OpenSSL format that the server will accept for TLS connections with a certificate.
          - If not specified, the server will use the system-wide default ciphers.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#tlsciphercert'
      zbxserver_tls_cipher_psk_13:
        type: str
        required: false
        description:
          - The list of ciphers in OpenSSL format that the server will accept for TLS 1.3 connections with a pre-shared key.
          - If not specified, the server will use the system-wide default ciphers.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#tlscipherpsk13'
      zbxserver_tls_cipher_psk:
        type: str
        required: false
        description:
          - The list of ciphers in OpenSSL format that the server will accept for TLS connections with a pre-shared key.
          - If not specified, the server will use the system-wide default ciphers.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#tlscipherpsk'
      zbxserver_tls_cipher_all_13:
        type: str
        required: false
        description:
          - The list of ciphers in OpenSSL format that the server will accept for all TLS 1.3 connections.
          - If not specified, the server will use the system-wide default ciphers.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#tlscipherall13'
      zbxserver_tls_cipher_all:
        type: str
        required: false
        description:
          - The list of ciphers in OpenSSL format that the server will accept for all TLS connections.
          - If not specified, the server will use the system-wide default ciphers.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#tlscipherall'
      zbxserver_ha_node_name:
        type: str
        required: false
        description:
          - The name of the Zabbix server node in a high-availability cluster.
          - This name must be unique within the cluster.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#hanodename'
      zbxserver_node_address:
        type: str
        required: false
        description:
          - The URL segment of the Zabbix server node in a high-availability cluster.
          - This should be in a format that can be used to construct a URL (e.g. <address>:<port-number>).
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#nodeaddress'
      zbxserver_log_type:
        type: str
        required: false
        default: file
        choices:
          - file
          - system
          - console
        description:
          - The type of logging to use for the Zabbix server.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#logtype'
      zbxserver_log_file:
        type: path
        required: false
        default: /var/log/zabbix/zabbix_server.log
        description:
          - The path to the log file for the Zabbix server.
          - This option is only used if *zbxserver_log_type* is set to `file`.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#logfile'
      zbxserver_log_file_size:
        type: int
        required: false
        description:
          - The maximum size of the log file in megabytes.
          - Valid values are between 0 and 1024.
          - If set to 0, the log file will not be rotated.
          - This option is only used if *zbxserver_log_type* is set to `file`.
          - If *zbxserver_manage_logrotate* is set to `true`, this option will default to and should be set to 0 to prevent conflicts.
          - If *zbxserver_manage_logrotate* is set to `false`, this option will default to 1.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#logfilesize'
      zbxserver_pid_file:
        type: path
        required: false
        default: /run/zabbix/zabbix_server.pid
        description:
          - The path to the PID file for the Zabbix server.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#pidfile'
      zbxserver_socket_dir:
        type: path
        required: false
        default: /run/zabbix
        description:
          - The directory in which the Zabbix server will create its socket file.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#socketdir'
      zbxserver_database_host:
        type: str
        required: false
        default: localhost
        description:
          - The host to which the Zabbix server will connect to the database.
          - If the database is PostgreSQL, setting this to an empty string will cause the server to connect via a Unix socket on the local system.
          - If the database is MySQL, setting this to `localhost` will cause the server to connect via a Unix socket on the local system.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#dbhost'
      zbxserver_database_socket:
        type: path
        required: false
        description:
          - The path to the MySQL Unix socket file for accessing the database.
          - This is only used if *zbxserver_database_type* is set to `mysql`.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#dbsocket'
      zbxserver_database_schema:
        type: str
        required: false
        description:
          - The schema to use for the Zabbix server database.
          - This is only used if *zbxproxy_database_type* is set to `postgresql`.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#dbschema'
      zbxserver_database_port:
        type: int
        required: false
        default: 5432
        description:
          - The port on which the Zabbix server will connect to the database.
          - Valid values are between 1024 and 65535.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#dbport'
      zbxserver_database_password:
        type: str
        required: false
        no_log: true
        description:
          - The password for the Zabbix server to connect to the database.
          - If *zbxserver_configure_vault* is set to `true`, this option will be ignored.
          - If *zbxserver_configure_vault* is set to `false` and *zbxserver_database_host* is not set to an empty string, this option must be set.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#dbpassword'
      zbxserver_allow_unsupported_db_versions:
        type: bool
        required: false
        default: true
        description:
          - Whether to allow the Zabbix server to connect to unsupported versions of the database.
          - This may be needed for newer versions of TimescaleDB.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#allowunsupporteddbversions'
      zbxserver_vault_database_mount_point:
        type: str
        required: false
        description:
          - The HashiCorp Vault KV2 mount point where the Zabbix server database secret is stored.
          - If *zbxserver_configure_vault* is set to `true`, this is required.  Otherwise, it will be ignored.
      zbxserver_vault_database_path:
        type: str
        required: false
        description:
          - The path within the HashiCorp Vault KV2 mount point where the Zabbix server database secret is stored.
          - The secret at this path must have the keys `username` and `password` defined.
          - If *zbxserver_configure_vault* is set to `true`, this is required.  Otherwise, it will be ignored.
      zbxserver_db_tls_connect:
        type: str
        required: false
        default: unencrypted
        choices:
          - unencrypted
          - require
          - verify_ca
          - verify_full
        description:
          - Defines the TLS behavior for connecting to the database.
          - If set to `unencrypted`, the server will not use TLS encryption.
          - If set to `require`, the server will use TLS encryption but will not validate the server certificate.
          - If set to `verify-ca`, the server will use TLS encryption and will validate the server certificate chain, but not the host name.
          - If set to `verify-full`, the server will use TLS encryption and will validate the server certificate chain and host name.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#dbtlsconnect'
      zbxserver_db_tls_ca_file:
        type: path
        required: false
        description:
          - The path to the CA certificate file used for validating the database server certificate.
          - If *zbxserver_db_tls_connect* is set to `verify-ca` or `verify-full`, this is required. Otherwise, it will be ignored.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#dbtlscacertfile'
      zbxserver_db_tls_cert_file:
        type: path
        required: false
        description:
          - The path to the client certificate file used for authenticating the Zabbix server to the database server.
          - If client certificate authentication is not being used, this option should not be set.
          - If *zbxserver_db_tls_key_file* is set, this option must also be set.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#dbtlscertfile'
      zbxserver_db_tls_key_file:
        type: path
        required: false
        description:
          - The path to the client private key file used for authenticating the Zabbix server to the database server.
          - If client certificate authentication is not being used, this option should not be set.
          - If *zbxserver_db_tls_cert_file* is set, this option must also be set.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#dbtlskeyfile'
      zbxserver_db_tls_cipher:
        type: str
        required: false
        description:
          - The list of ciphers in OpenSSL format that the server will accept for TLS connections to the database.
          - If not specified, the server will use the system-wide default ciphers.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#dbtlscipher'
      zbxserver_db_tls_cipher_13:
        type: str
        required: false
        description:
          - The list of ciphers in OpenSSL format that the server will accept for TLS 1.3 connections to the database.
          - If not specified, the server will use the system-wide default ciphers.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#dbtlscipher13'
      zbxserver_vault_token:
        type: str
        required: false
        description:
          - The token used to authenticate to HashiCorp Vault.
          - If *zbxserver_configure_vault* is set to `true`, this is required. Otherwise, it will be ignored.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#vaulttoken'
      zbxserver_vault_url:
        type: str
        required: false
        description:
          - The URL of the HashiCorp Vault server.
          - If *zbxserver_configure_vault* is set to `true`, this option must be set. Otherwise, it will be ignored.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#vaulturl'
      zbxserver_history_storage:
        type: bool
        required: false
        default: false
        description:
          - Whether to enable history storage in ElasticSearch/OpenSearch.
      zbxserver_history_storage_url:
        type: str
        required: false
        description:
          - The URL of the ElasticSearch/OpenSearch server.
          - If *zbxserver_history_storage* is set to `true`, this is required.  Otherwise, it will be ignored.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#historystorageurl'
      zbxserver_history_storage_types:
        type: list
        required: false
        default:
          - uint
          - dbl
          - str
          - log
          - text
        elements: str
        choices:
          - uint
          - dbl
          - str
          - log
          - text
        description:
          - The index in ElasticSearch/OpenSearch where the Zabbix server will store history data.
          - If *zbxserver_history_storage* is set to `true`, this is required. Otherwise, it will be ignored.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#historystoragetypes'
      zbxserver_history_storage_date_index:
        type: bool
        required: false
        default: false
        description:
          - Whether to create a separate index for each day's history data.
          - If *zbxserver_history_storage* is set to `true`, this is required. Otherwise, it will be ignored.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#historystoragedateindex'
      zbxserver_export:
        type: bool
        required: false
        default: false
        description:
          - Whether to enable export of historical data.
      zbxserver_export_dir:
        type: path
        required: false
        description:
          - The directory in which the Zabbix server will store exported historical data.
          - If *zbxserver_export* is set to `true`, this is required. Otherwise, it will be ignored.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#exportdir'
      zbxserver_export_file_size:
        type: bytes
        required: false
        default: 1G
        description:
          - The maximum size of the exported data files.
          - If *zbxserver_export* is set to `true`, this is required. Otherwise, it will be ignored.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#exportfilesize'
      zbxserver_export_type:
        type: list
        required: false
        default:
          - events
          - history
          - trends
        elements: str
        choices:
          - events
          - history
          - trends
        description:
          - The types of data to export.
          - If *zbxserver_export* is set to `true`, this is required. Otherwise, it will be ignored.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#exporttype'
      zbxserver_start_pollers:
        type: int
        required: false
        default: 5
        description:
          - The number of poller processes to start.
          - Valid values are between 0 and 1000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startpollers'
      zbxserver_start_agent_pollers:
        type: int
        required: false
        default: 1
        description:
          - The number of agent poller processes to start.
          - Valid values are between 0 and 1000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startagentpollers'
      zbxserver_start_browser_pollers:
        type: int
        required: false
        default: 1
        description:
          - The number of browser poller processes to start.
          - Valid values are between 0 and 1000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startbrowserpollers'
      zbxserver_start_http_agent_pollers:
        type: int
        required: false
        default: 1
        description:
          - The number of HTTP agent poller processes to start.
          - Valid values are between 0 and 1000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#starthttpagentpollers'
      zbxserver_start_snmp_pollers:
        type: int
        required: false
        default: 1
        description:
          - The number of asynchronous SNMP poller processes to start.
          - Valid values are between 0 and 1000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startsnmppollers'
      zbxserver_start_ipmi_pollers:
        type: int
        required: false
        default: 0
        description:
          - The number of IPMI poller processes to start.
          - Valid values are between 0 and 1000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startipmipollers'
      zbxserver_start_pollers_unreachable:
        type: int
        required: false
        default: 1
        description:
          - The number of poller processes to start for unreachable hosts.
          - Valid values are between 0 and 1000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startpollersunreachable'
      zbxserver_start_preprocessors:
        type: int
        required: false
        default: 16
        description:
          - The number of preprocessor processes to start.
          - Valid values are between 0 and 1000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startpreprocessors'
      zbxserver_start_history_pollers:
        type: int
        required: false
        default: 5
        description:
          - The number of history poller processes to start.
          - Valid values are between 0 and 1000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#starthistorypollers'
      zbxserver_start_trappers:
        type: int
        required: false
        default: 5
        description:
          - The number of trapper processes to start.
          - Valid values are between 0 and 1000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#starttrappers'
      zbxserver_start_pingers:
        type: int
        required: false
        default: 1
        description:
          - The number of pinger processes to start.
          - Valid values are between 0 and 1000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startpingers'
      zbxserver_start_discoverers:
        type: int
        required: false
        default: 5
        description:
          - The number of discoverer processes to start.
          - Valid values are between 0 and 1000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startdiscoverers'
      zbxserver_start_http_pollers:
        type: int
        required: false
        default: 1
        description:
          - The number of HTTP poller processes to start.
          - Valid values are between 0 and 1000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#starthttppollers'
      zbxserver_start_connecctors:
        type: int
        required: false
        default: 0
        description:
          - The number of connector processes to start.
          - Valid values are between 0 and 1000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startconnectors'
      zbxserver_start_timers:
        type: int
        required: false
        default: 1
        description:
          - The number of timer processes to start.
          - Valid values are between 1 and 1000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#starttimers'
      zbxserver_start_escalators:
        type: int
        required: false
        default: 1
        description:
          - The number of escalator processes to start.
          - Valid values are between 1 and 100.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startescalators'
      zbxserver_start_alerters:
        type: int
        required: false
        default: 3
        description:
          - The number of alerter processes to start.
          - Valid values are between 1 and 100.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startalerters'
      zbxserver_start_java_pollers:
        type: int
        required: false
        default: 0
        description:
          - The number of Java poller processes to start.
          - Valid values are between 0 and 1000.
          - If *zbxserver_use_java_gateway* is set to `false`, this is ignored.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startjavapollers'
      zbxserver_start_vmware_collectors:
        type: int
        required: false
        default: 0
        description:
          - The number of VMware collector processes to start.
          - Valid values are between 0 and 250.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startvmwarecollectors'
      zbxserver_start_snmp_trapper:
        type: int
        required: false
        default: 0
        description:
          - The number of SNMP trapper processes to start.
          - Valid values are between 0 and 1.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startsnmptrapper'
      zbxserver_start_db_syncers:
        type: int
        required: false
        default: 4
        description:
          - The number of database syncer processes to start.
          - Valid values are between 1 and 100.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startdbsyncers'
      zbxserver_start_proxy_pollers:
        type: int
        required: false
        default: 1
        description:
          - The number of proxy poller processes to start.
          - Valid values are between 0 and 250.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startproxypollers'
      zbxserver_start_lld_processors:
        type: int
        required: false
        default: 2
        description:
          - The number of low-level discovery (LLD) processor processes to start.
          - Valid values are between 0 and 100.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startlldprocessors'
      zbxserver_start_report_writers:
        type: int
        required: false
        default: 0
        description:
          - The number of report writer processes to start.
          - Valid values are between 0 and 100.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startreportwriters'
      zbxserver_start_odbc_pollers:
        type: int
        required: false
        default: 1
        description:
          - The number of ODBC poller processes to start.
          - Valid values are between 0 and 1000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#startodbcpollers'
      zbxserver_cache_size:
        type: bytes
        required: false
        default: 32M
        description:
          - The size of the cache in memory.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#cachesize'
      zbxserver_history_cache_size:
        type: bytes
        required: false
        default: 8M
        description:
          - The size of the history cache in memory.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#historycachesize'
      zbxserver_history_index_cache_size:
        type: bytes
        required: false
        default: 4M
        description:
          - The size of the history index cache in memory.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#historyindexcachesize'
      zbxserver_trend_cache_size:
        type: bytes
        required: false
        default: 4M
        description:
          - The size of the trend cache in memory.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#trendcachesize'
      zbxserver_trend_function_cache_size:
        type: bytes
        required: false
        default: 4M
        description:
          - The size of the trend function cache in memory.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#trendfunctioncachesize'
      zbxserver_value_cache_size:
        type: bytes
        required: false
        default: 8M
        description:
          - The size of the value cache in memory.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#valuecachesize'
      zbxserver_vmware_cache_size:
        type: bytes
        required: false
        default: 8M
        description:
          - The size of the VMware cache in memory.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#vmwarecachesize'
      zbxserver_max_concurrent_checks_per_poller:
        type: int
        required: false
        default: 1000
        description:
          - The maximum number of checks that can be processed concurrently by a poller process.
          - Valid values are between 1 and 1000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#maxconcurrentchecksperpoller'
      zbxserver_use_java_gateway:
        type: bool
        required: false
        default: false
        description:
          - Whether to use the Java Gateway for monitoring.
      zbxserver_java_gateway:
        type: str
        required: false
        description:
          - The IP address or hostname of the Java Gateway.
          - If *zbxserver_use_java_gateway* is set to `true`, this is required. Otherwise, it will be ignored.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#javagateway'
      zbxserver_java_gateway_port:
        type: int
        required: false
        default: 10052
        description:
          - The port on which the Java Gateway will listen for incoming connections.
          - Valid values are between 1024 and 32767.
          - If *zbxserver_use_java_gateway* is set to `false`, this will be ignored.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#javagatewayport'
      zbxserver_vmware_frequency:
        type: int
        required: false
        default: 60
        description:
          - The frequency in seconds at which the Zabbix server will poll VMware data.
          - Valid values are between 10 and 86400.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#vmwarefrequency'
      zbxserver_vmware_perf_frequency:
        type: int
        required: false
        default: 60
        description:
          - The frequency in seconds at which the Zabbix server will poll VMware performance data.
          - Valid values are between 10 and 86400.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#vmwareperffrequency'
      zbxserver_vmware_timeout:
        type: int
        required: false
        default: 10
        description:
          - The timeout in seconds for VMware data collection.
          - Valid values are between 1 and 300.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#vmwaretimeout'
      zbxserver_snmp_trapper_file:
        type: path
        required: false
        default: /tmp/zabbix_traps.tmp
        description:
          - The path to the file where SNMP traps will be stored.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#snmptrapperfile'
      zbxserver_housekeeping_frequency:
        type: int
        required: false
        default: 1
        description:
          - The frequency in hours at which the Zabbix server will perform housekeeping tasks.
          - Valid values are between 0 and 24.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#housekeepingfrequency'
      zbxserver_max_housekeeper_delete:
        type: int
        required: false
        default: 5000
        description:
          - The maximum number of records to delete during housekeeping.
          - Valid values are between 0 and 1000000.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#maxhousekeeperdelete'
      zbxserver_problem_housekeeping_frequency:
        type: int
        required: false
        default: 60
        description:
          - The frequency in seconds at which the Zabbix server will perform problem housekeeping tasks.
          - Valid values are between 1 and 3600.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#problemhousekeepingfrequency'
      zbxserver_cache_update_frequency:
        type: int
        required: false
        default: 10
        description:
          - The frequency in seconds at which the Zabbix server will update the cache.
          - Valid values are between 1 and 3600.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#cacheupdatefrequency'
      zbxserver_timeout:
        type: int
        required: false
        default: 3
        description:
          - The timeout in seconds for processing requests.
          - Valid values are between 1 and 30.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#timeout'
      zbxserver_trapper_timeout:
        type: int
        required: false
        default: 300
        description:
          - The timeout in seconds for processing trapper requests.
          - Valid values are between 1 and 300.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#trappertimeout'
      zbxserver_unreachable_period:
        type: int
        required: false
        default: 45
        description:
          - The period with no response in seconds after which a host is considered unavailable.
          - Valid values are between 1 and 3600.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#unreachableperiod'
      zbxserver_unreachable_delay:
        type: int
        required: false
        default: 15
        description:
          - The period in seconds between checks for hosts that did not respond previously but are not yet considered unavailable.
          - Valid values are between 1 and 3600.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#unreachabledelay'
      zbxserver_unavailable_delay:
        type: int
        required: false
        default: 60
        description:
          - The period in seconds between checks for hosts that are considered unavailable.
          - Valid values are between 1 and 3600.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#unavailabledelay'
      zbxserver_alert_scripts_path:
        type: path
        required: false
        default: /usr/lib/zabbix/alertscripts
        description:
          - The path to the directory where alert scripts are stored.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#alertscripts'
      zbxserver_external_scripts:
        type: path
        required: false
        default: /usr/lib/zabbix/externalscripts
        description:
          - The path to the directory where external scripts are stored.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#externalscripts'
      zbxserver_fping_location:
        type: path
        required: false
        default: /usr/sbin/fping
        description:
          - The path to the fping binary.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#fpinglocation'
      zbxserver_fping6_location:
        type: path
        required: false
        default: /usr/sbin/fping6
        description:
          - The path to the fping6 binary.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#fping6location'
      zbxserver_ssh_key_location:
        type: path
        required: false
        description:
          - The path to the SSH key used for SSH checks.
          - If not specified, the default SSH key will be used.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#sshkeylocation'
      zbxserver_tmp_dir:
        type: path
        required: false
        default: /tmp
        description:
          - The directory in which the Zabbix server will store temporary files.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#tmpdir'
      zbxserver_proxy_config_frequency:
        type: int
        required: false
        default: 10
        description:
          - The frequency in seconds at which the Zabbix server will synchronize with the proxy configuration.
          - Valid values are between 1 and 604800.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#proxyconfigfrequency'
      zbxserver_proxy_data_frequency:
        type: int
        required: false
        default: 1
        description:
          - The frequency in seconds at which the Zabbix server will synchronize with the proxy data.
          - Valid values are between 1 and 3600.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#proxydatafrequency'
      zbxserver_sms_devices:
        type: list
        required: false
        elements: str
        description:
          - A list of SMS modem devices to use for sending notifications.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#smsdevices'
      zbxserver_include_files:
        type: list
        elements: path
        required: false
        description:
          - A list of paths to additional configuration files to include in the Zabbix server configuration.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#include'
      zbxserver_include_directories:
        type: list
        elements: path
        required: false
        description:
          - A list of directories containing additional configuration files to include in the Zabbix server configuration.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#include'
      zbxserver_ssl_cert_location:
        type: path
        required: false
        description:
          - The path to the SSL certificate files to use in web monitoring.
          - If not specified, the server will not use SSL client certificates for web monitoring.
          - If specified, the *zbxserver_ssl_key_location* option must also be specified.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#sslcertlocation'
      zbxserver_ssl_key_location:
        type: path
        required: false
        description:
          - The path to the SSL key files to use in web monitoring.
          - If not specified, the server will not use SSL client certificates for web monitoring.
          - If specified, the *zbxserver_ssl_cert_location* option must also be specified.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#sslkeylocation'
      zbxserver_load_module_path:
        type: path
        required: false
        description:
          - The path to the directory containing loadable modules.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#loadmodulepath'
      zbxserver_load_modules:
        type: list
        elements: str
        required: false
        description:
          - A list of loadable modules to load.
          - 'Reference: https://www.zabbix.com/documentation/current/en/manual/appendix/config/zabbix_server#loadmodule'
      zbxserver_vault_users_mount_point:
        type: str
        required: false
        description:
          - The HashiCorp Vault KV2 mount point where the Zabbix server user secrets are stored.
      zbxserver_vault_users_base_path:
        type: str
        required: false
        description:
          - The base path within the HashiCorp Vault KV2 mount point where the Zabbix server user secrets are stored.
          - The value should not include a trailing slash.
      zbxserver_user_groups:
        type: list
        required: false
        default: []
        elements: dict
        description:
          - A list of user groups to create in the Zabbix server.
        options:
          name:
            type: str
            required: true
            description:
              - The name of the user group.
          gui_access:
            type: str
            required: false
            choices:
              - default
              - internal
              - LDAP
              - disable
            description:
              - Whether the user has GUI access and the authentication method to use.
          host_group_rights:
            type: list
            required: false
            elements: dict
            description:
              - A list of host group rights for the user group.
            options:
              host_group:
                type: str
                required: true
                description:
                  - The name of the host group.
              permission:
                type: str
                required: true
                choices:
                  - denied
                  - read-only
                  - read-write
                description:
                  - The permission level for the host group.
          template_group_rights:
            type: list
            required: false
            elements: dict
            description:
              - A list of template group rights for the user group.
            options:
              template_group:
                type: str
                required: true
                description:
                  - The name of the host group.
              permission:
                type: str
                required: true
                choices:
                  - denied
                  - read-only
                  - read-write
                description:
                  - The permission level for the host group.
      zbxserver_vault_managed_users:
        type: list
        required: false
        default:
          - username: ansible
            role_name: Super admin role
        elements: dict
        description:
          - A list of users whose credentials are stored in HashiCorp Vault.
          - Each user should be specified as a string.
        options:
          username:
            type: str
            required: true
            description:
              - The username of the user.
          password:
            type: str
            required: false
            no_log: true
            description:
              - The password of the user.
              - If not specified, the password will be generated before storing in HashiCorp Vault.
          name:
            type: str
            required: false
            description:
              - The display name of the user.
              - If not specified, the username will be used.
          surname:
            type: str
            required: false
            description:
              - The surname of the user.
          groups:
            type: list
            required: false
            elements: str
            description:
              - A list of groups to which the user belongs.
          role_name:
            type: str
            required: true
            description:
              - The name of the role to assign to the user.
          lang:
            type: str
            required: false
            choices:
              - en_GB
              - en_US
              - zh_CN
              - cs_CZ
              - fr_FR
              - he_IL
              - it_IT
              - ko_KR
              - ja_JP
              - nb_NO
              - pl_PL
              - pt_BR
              - pt_PT
              - ru_RU
              - sk_SK
              - tr_TR
              - uk_UA
              - default
            description:
              - The language to use for the user.
          refresh:
            type: int
            required: false
            description:
              - The period in seconds at which the user's credentials should be refreshed.
          theme:
            type: str
            required: false
            default: default
            choices:
              - default
              - blue-theme
              - dark-theme
            description:
              - The theme to use for the user.
          timezone:
            type: str
            required: false
            description:
              - The timezone to use for the user.
          user_medias:
            type: list
            required: false
            elements: dict
            description:
              - A list of media entries for the user.
            options:
              active:
                type: bool
                required: false
                default: true
                description:
                  - Whether the media entry is active.
              mediatype:
                type: str
                required: true
                description:
                  - The type of media.
              period:
                type: int
                required: false
                description:
                  - The period in seconds at which the media should be checked.
              sendto:
                type: raw
                required: true
                description:
                  - The address to which the media should be sent.
              severity:
                type: dict
                required: false
                description:
                  - The severity levels at which the media should be sent.
                options:
                  not_classified:
                    type: bool
                    required: false
                    default: true
                    description:
                      - Whether to send notifications for not classified events.
                  information:
                    type: bool
                    required: false
                    default: true
                    description:
                      - Whether to send notifications for information events.
                  warning:
                    type: bool
                    required: false
                    default: true
                    description:
                      - Whether to send notifications for information events.
                  average:
                    type: bool
                    required: false
                    default: true
                    description:
                      - Whether to send notifications for average events.
                  high:
                    type: bool
                    required: false
                    default: true
                    description:
                      - Whether to send notifications for high events.
                  disaster:
                    type: bool
                    required: false
                    default: true
                    description:
                      - Whether to send notifications for disaster events.
      zbxserver_unmanaged_users:
        type: list
        required: false
        default: []
        elements: dict
        description:
          - A list of users that are not managed in HashiCorp Vault.
        options:
          username:
            type: str
            required: true
            description:
              - The username of the user.
          password:
            type: str
            required: true
            no_log: true
            description:
              - The password of the user.
          name:
            type: str
            required: false
            description:
              - The display name of the user.
              - If not specified, the username will be used.
          surname:
            type: str
            required: false
            description:
              - The surname of the user.
          groups:
            type: list
            required: false
            elements: str
            description:
              - A list of groups to which the user belongs.
          role_name:
            type: str
            required: true
            description:
              - The name of the role to assign to the user.
          lang:
            type: str
            required: false
            choices:
              - en_GB
              - en_US
              - zh_CN
              - cs_CZ
              - fr_FR
              - he_IL
              - it_IT
              - ko_KR
              - ja_JP
              - nb_NO
              - pl_PL
              - pt_BR
              - pt_PT
              - ru_RU
              - sk_SK
              - tr_TR
              - uk_UA
              - default
            description:
              - The language to use for the user.
          refresh:
            type: int
            required: false
            description:
              - The period in seconds at which the user's credentials should be refreshed.
          theme:
            type: str
            required: false
            default: default
            choices:
              - default
              - blue-theme
              - dark-theme
            description:
              - The theme to use for the user.
          timezone:
            type: str
            required: false
            description:
              - The timezone to use for the user.
          user_medias:
            type: list
            required: false
            elements: dict
            description:
              - A list of media entries for the user.
            options:
              active:
                type: bool
                required: false
                default: true
                description:
                  - Whether the media entry is active.
              media_type:
                type: str
                required: true
                description:
                  - The type of media.
              period:
                type: int
                required: false
                description:
                  - The period in seconds at which the media should be checked.
              sendto:
                type: raw
                required: true
                description:
                  - The address to which the media should be sent.
              severity:
                type: dict
                required: false
                description:
                  - The severity levels at which the media should be sent.
                options:
                  not_classified:
                    type: bool
                    required: false
                    default: true
                    description:
                      - Whether to send notifications for not classified events.
                  information:
                    type: bool
                    required: false
                    default: true
                    description:
                      - Whether to send notifications for information events.
                  warning:
                    type: bool
                    required: false
                    default: true
                    description:
                      - Whether to send notifications for information events.
                  average:
                    type: bool
                    required: false
                    default: true
                    description:
                      - Whether to send notifications for average events.
                  high:
                    type: bool
                    required: false
                    default: true
                    description:
                      - Whether to send notifications for high events.
                  disaster:
                    type: bool
                    required: false
                    default: true
                    description:
                      - Whether to send notifications for disaster events.
      zbxserver_ldap_directories:
        type: list
        required: false
        default: []
        elements: dict
        description:
          - A list of LDAP directories to configure for the Zabbix server.
        options:
          name:
            type: str
            required: true
            description:
              - The name of the LDAP directory within Zabbix server.
          host:
            type: str
            required: true
            description:
              - The hostname or IP address of the LDAP server.
          encryption:
            type: str
            required: false
            default: unencrypted
            choices:
              - unencrypted
              - ldaps
              - starttls
            description:
              - The type of encryption to use for the LDAP connection.
          port:
            type: int
            required: false
            description:
              - The port on which the LDAP server is listening.
              - If using LDAPS, the default is 636. Otherwise, the default is 389.
          description:
            type: str
            required: false
            description:
              - A description of the LDAP directory.
          base_dn:
            type: str
            required: true
            description:
              - The base distinguished name for querying the LDAP directory.
          filter:
            type: str
            required: false
            description:
              - The filter to use when authenticating users.
          bind_dn:
            type: str
            required: false
            description:
              - The distinguished name to use for binding to the LDAP server.
              - If anonymous binding is allowed and desired, this should not be set.
          bind_password:
            type: str
            required: false
            no_log: true
            description:
              - The password to use for binding to the LDAP server.
              - If anonymous binding is allowed and desired, this should not be set.
          username_attribute:
            type: str
            required: false
            default: sAMAccountName
            description:
              - The attribute to use for the username.
          name_attribute:
            type: str
            required: false
            default: displayName
            description:
              - The attribute to use for the user's first name.
          last_name_attribute:
            type: str
            required: false
            default: sn
            description:
              - The attribute to use for the user's last name.
          email_attribute:
            type: str
            required: false
            default: mail
            description:
              - The attribute to use for the user's email address.
          user_group_attribute:
            type: str
            required: false
            default: memberOf
            description:
              - The attribute to use for the user's group membership.
          group_mappings:
            type: list
            required: false
            default: []
            elements: dict
            description:
              - A list of group mappings for the LDAP directory.
            options:
              name:
                type: str
                required: true
                description:
                  - The name of the group in the LDAP directory.
                  - Use '*' to match users that don't match any other group.
              role:
                type: str
                required: true
                description:
                  - The name of the role to assign to users that match this group.
              user_groups:
                type: list
                required: false
                elements: str
                description:
                  - A list of Zabbix user groups to assign to users that match this group.
      zbxserver_saml_directories:
        type: list
        required: false
        default: []
        elements: dict
        description:
          - A list of SAML directories to configure for the Zabbix server.
        options:
          name:
            type: str
            required: true
            description:
              - The name of the LDAP directory within Zabbix server.
          sp_entity_id:
            type: str
            required: true
            description:
              - The entity ID of the Zabbix server.
          idp_entity_id:
            type: str
            required: true
            description:
              - The entity ID of the identity provider.
          sso_url:
            type: str
            required: true
            description:
              - The URL to use for single sign-on.
          slo_url:
            type: str
            required: false
            description:
              - The URL to use for single logout.
          encrypt_assertions:
            type: bool
            required: false
            default: false
            description:
              - Whether to encrypt SAML assertions.
          encrypt_nameid:
            type: bool
            required: false
            default: false
            description:
              - Whether to encrypt the NameID.
          sign_assertions:
            type: bool
            required: false
            default: false
            description:
              - Whether to sign SAML assertions.
          sign_authn_requests:
            type: bool
            required: false
            default: false
            description:
              - Whether to sign SAML AuthN responses.
          sign_logout_requests:
            type: bool
            required: false
            default: false
            description:
              - Whether to sign SAML logout requests.
          sign_logout_responses:
            type: bool
            required: false
            default: false
            description:
              - Whether to sign SAML logout responses.
          sign_messages:
            type: bool
            required: false
            default: false
            description:
              - Whether to sign SAML messages.
          username_attribute:
            type: str
            required: false
            default: NameID
            description:
              - The attribute to use for the username.
          name_format:
            type: str
            required: false
            default: urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified
            description:
              - The format to use for the NameID.
          name_attribute:
            type: str
            required: false
            default: DisplayName
            description:
              - The attribute to use for the user's first name.
          surname_attribute:
            type: str
            required: false
            default: LastName
            description:
              - The attribute to use for the user's last name.
          email_attribute:
            type: str
            required: false
            default: Email
            description:
              - The attribute to use for the user's email address.
          user_group_attribute:
            type: str
            required: false
            default: Groups
            description:
              - The attribute to use for the user's group membership.
          group_mappings:
            type: list
            required: false
            default: []
            elements: dict
            description:
              - A list of group mappings for the SAML directory.
            options:
              name:
                type: str
                required: true
                description:
                  - The name of the group in the SAML directory.
                  - Use '*' to match users that don't match any other group.
              role:
                type: str
                required: true
                description:
                  - The name of the role to assign to users that match this group.
              user_groups:
                type: list
                required: false
                elements: str
                description:
                  - A list of Zabbix user groups to assign to users that match this group.
      zbxserver_default_auth_type:
        type: str
        required: false
        default: internal
        choices:
          - internal
          - ldap
        description:
          - The default authentication type to use for users.
      zbxserver_disabled_users_group:
        type: str
        required: false
        default: Disabled
        description:
          - The name of the user group to which disabled users should be moved.
      zbxserver_min_password_length:
        type: int
        required: false
        default: 8
        description:
          - The minimum length of a user's password.
      zbxserver_password_complexity:
        type: list
        required: false
        default:
          - avoid_easy_to_guess
        elements: str
        choices:
          - contain_uppercase_and_lowercase_letters
          - contain_digits
          - contain_special_characters
          - avoid_easy_to_guess
        description:
          - The complexity level of a user's password.
      zbxserver_jit_provisioning_interval:
        type: str
        required: false
        default: 1h
        description:
          - The interval in seconds at which just-in-time provisioning should be performed.
      zbxserver_ldap_enabled:
        type: bool
        required: false
        description:
          - Whether LDAP authentication is enabled.
          - If *zbxserver_ldap_directories* is specified, this will default to `true`. Otherwise, it will default to `false`.
      zbxserver_ldap_jit_status:
        type: bool
        required: false
        default: false
        description:
          - Whether just-in-time provisioning is enabled for LDAP users.
      zbxserver_active_ldap_directory:
        type: str
        required: false
        description:
          - The name of the LDAP directory to use for authentication.
          - If *zbxserver_ldap_enabled* is set to `true`, this is required.
      zbxserver_saml_enabled:
        type: bool
        required: false
        description:
          - Whether SAML authentication is enabled.
          - If *zbxserver_saml_directories* is specified, this will default to `true`. Otherwise, it will default to `false`.
      zbxserver_saml_jit_status:
        type: bool
        required: false
        default: false
        description:
          - Whether just-in-time provisioning is enabled for SAML users.
      zbxserver_logrotate_period:
        type: str
        required: false
        default: daily
        choices:
          - daily
          - weekly
          - monthly
        description:
          - The period at which logrotate should rotate the Zabbix server's log file.
      zbxserver_logrotate_retention:
        type: int
        required: false
        default: 14
        description:
          - The number of rotated log files to retain.
      zbxserver_logrotate_mode:
        type: str
        required: false
        default: '0640'
        description:
          - The permissions to set on the rotated log files.
      zbxserver_templates:
        type: list
        required: false
        default: []
        elements: path
        description:
          - A list of templates to import into the Zabbix server from a path on the controller node.
